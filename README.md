# 📦 Warehouse-Inventory-System (WIS)

**Warehouse-Inventory-System** — это высокопроизводительный бэкенд-сервис для автоматизации учета металлопроката на складе. Система спроектирована как отказоустойчивое решение для мониторинга жизненного цикла рулонов металла с модулем глубокой аналитики операционной деятельности в режиме реального времени.

[![Runtime](https://img.shields.io/badge/.NET-10.0-blueviolet)](https://dotnet.microsoft.com/)
[![Architecture](https://img.shields.io/badge/Architecture-Clean--Architecture-green)](#🏗-архитектура)
[![Tests](https://img.shields.io/badge/Tests-xUnit%20%7C%20NSubstitute-brightgreen)](#🧪-тестирование-и-качество)
[![Database](https://img.shields.io/badge/Database-PostgreSQL-blue)](https://www.postgresql.org/)

---

## 🚀 Ключевые возможности

- **Rich Domain Model:** Использование «богатой» модели домена. Сущности (`Roll`) самостоятельно управляют своим состоянием.
- **Advanced Query Engine:** Система динамической фильтрации с поддержкой множественных диапазонов. Позволяет комбинировать запросы по ID, физическим параметрам (вес/длина) и временным интервалам пересечения.
- **Infrastructure Isolation:** Полная независимость бизнес-логики от способа хранения данных. Архитектура готова к смене способа хранения (PostgreSQL, File System) без изменения ядра системы.

---

## 🏗 Архитектура

Проект реализован в соответствии с принципами **Clean Architecture** и **DDD**:

- **`Domain`**: Ядро системы. Содержит доменные сущности, Value Objects (`Weight`, `Length`). Полностью изолирован от внешних фреймворков.
- **`Application`**: Слой сценариев (Use Cases). Содержит логику оркестрации, контракты DTO и реализацию паттерна **Result** для обработки бизнес-ошибок без использования исключений.
- **`Infrastructure`**: Реализация доступа к данным. Включает Persistence Context (EF Core), маппинги сущностей БД, механизмы миграций и глобальную обработку исключений через Middleware.
- **`Presentation`**: Слой REST API. Реализует семантически корректные эндпоинты, интеграцию со Swagger и валидацию входящих запросов.

---

## 🛠 Технологический стек

- **Runtime:** `.NET 10` (C# 13)
- **Database:** `PostgreSQL 17` (основная), `EF Core InMemory` (тестовая)
- **ORM:** `Entity Framework Core 10` (Fluent API, Shadow Properties, Value Conversions)
- **Automation:** `Makefile` (Task Runner для локальной разработки)
- **Containerization:** `Docker` & `Docker Compose`
- **Config Management:** `DotNetEnv` (поддержка `.env` файлов)

---

## 📊 Аналитический модуль
Сервис выполняет сложную математическую агрегацию данных за произвольный период:
- **Операционная сводка:** Точный подсчет добавленных и удаленных единиц продукции.
- **Физические агрегаты:** Вычисление средних, максимальных и минимальных значений веса и длины для всех рулонов, находившихся на складе.
- **Анализ хранения:** Расчет временных интервалов между поступлением и списанием.
- **Экстремумы нагрузки:** Автоматическое определение конкретных дней с пиковой загрузкой склада в тоннах и штуках.

---

## 🧪 Тестирование и качество

Проект придерживается стратегии многоуровневого тестирования:

- **Инструментарий:** `xUnit`, `FluentAssertions`, `NSubstitute`.
- **Уровни тестирования:**
    - **Domain Tests:** Unit-тестирование правил валидации и жизненного цикла сущностей.
    - **Application Tests:** Тестирование сервисов с полной изоляцией через моки (`NSubstitute`).
    - **Infrastructure Tests:** Тестирование репозиториев и сложных LINQ-фильтров на `InMemory` провайдере.

---